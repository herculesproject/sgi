
# Entrega 24-07-2025
## Versiones

* sgdoc-service: 0.3.0
* sgi-cnf-service: 0.8.0
* sgi-com-service: 0.5.0
* sgi-csp-service: 0.10.0
* sgi-eer-service: 0.3.0
* sgi-esb: 0.8.0-um
  * common: 0.2.0
  * sgdoc: 0.1.0
  * sge: 0.7.0-um
  * sgemp: 0.3.0-um
  * sgepii: 0.2.0
  * sgi: 0.2.0
  * sgo: 0.2.0-um
  * sgp: 0.3.1-um
* sgi-eti-service: 0.7.0
* sgi-keycloak: 0.4.0
* sgi-pii-service: 0.6.0
* sgi-prc-service: 0.4.0
* sgi-rel-service: 0.3.0
* sgi-rep-service: 0.6.0
* sgi-tp-service: 0.4.0
* sgi-usr-service: 0.4.0
* sgi-webapp: 0.11.0
* sgo-service: 0.2.0-um

## Instrucciones actualización 
### Revisar Guía de Actualización a la nueva versión con soporte multi-idioma
* [Ver guía](../guia-actualizacion/guia-actualizacion.md)

### Despliegue
Para actualizar la versión actual instalada (**20250227**) a la última versión disponible (**20250724**), es necesario realizar los siguientes cambios en el fichero de configuración:
* Reemplazar el tag de cada uno de los siguientes servicios al indicado:
    * sgdoc-service: 0.3.0
    * sgi-cnf-service: 0.8.0
    * sgi-com-service: 0.5.0
    * sgi-csp-service: 0.10.0
    * sgi-eer-service: 0.3.0
    * sgi-esb: 0.8.0-um
    * sgi-eti-service: 0.7.0
    * sgi-pii-service: 0.6.0
    * sgi-prc-service: 0.4.0
    * sgi-rel-service: 0.3.0
    * sgi-rep-service: 0.6.0
    * sgi-tp-service: 0.4.0
    * sgi-usr-service: 0.4.0
    * sgi-webapp: 0.11.0
* Añadir en **extraEnvVariables** de **sgi-com-service** la variable **SGI_REST_API_CNF** con la url del servicio **sgi-cnf-service**:
	```
	- name: SGI_REST_API_CNF-URL
      value: "http://sgi-sgi-cnf-service"
	```

Una vez modificada la  versión de despliegue, podemos proceder a la actualización de la aplicación ejecutando el siguiente comando (sustituir **<namespace>** con el nombre del **namespace** de **Kubernetes** correspondiente):

helm repo update
helm upgrade sgi treelogic_helm_nexus_repo/sgi-umbrella --timeout 10m0s --wait --wait-for-jobs --install --namespace <namespace> --version 0.1.46 -f ./values.sgi-dev.yaml

### Servicios con scripts de actualización de datos
Lista de servicios que incluyen cambios en el modelo de datos y/o actualizaciones de datos: 
* sgi-cnf-service ([Ver cambios](../sgi-cnf-service/src/main/resources/db/changelog/changes/0.8.0))
* sgi-com-service ([Ver cambios](../sgi-com-service/src/main/resources/db/changelog/changes/0.5.0))
* sgi-csp-service ([Ver cambios](../sgi-csp-service/src/main/resources/db/changelog/changes/0.10.0))
* sgi-eer-service ([Ver cambios](../sgi-eer-service/src/main/resources/db/changelog/changes/0.3.0))
* sgi-eti-service ([Ver cambios](../sgi-eti-service/src/main/resources/db/changelog/changes/0.7.0))
* sgi-pii-service ([Ver cambios](../sgi-pii-service/src/main/resources/db/changelog/changes/0.6.0))
* sgi-rel-service ([Ver cambios](../sgi-rel-service/src/main/resources/db/changelog/changes/0.3.0))

## Changelog entrega 24-07-2025

### sgdoc-service (Versión 0.3.0)
* #### Nueva funcionalidad
  * Añadido soporte multi-idioma.

### sgi-cnf-service (Versión 0.8.0)
* #### Nueva funcionalidad
  * Añadido soporte multi-idioma.
* #### Mejoras
  * Actualizado a Java 21.

### sgi-com-service (Versión 0.5.0)
* #### Nueva funcionalidad
  * Añadido soporte multi-idioma.
* #### Mejoras
  * Actualizado a Java 21.
  * Incorporación de plantillas genéricas por defecto para facilitar la reutilización y la personalización.

### sgi-csp-service (Versión 0.10.0)
* #### Nueva funcionalidad
  * Añadido soporte multi-idioma.
* #### Mejoras
  * Actualizado a Java 21.
  * Se permite la creación de solicitudes sin estar vinculadas a una convocatoria, tanto para el perfil de investigación como para el perfil de gestión.
  * Añadida la funcionalidad para que se pueda relacionar un proyecto con un grupo de investigación.
  * Se incluye parámetro de configuración para habilitar/deshabilitar las notificaciones de presupuesto al SGE.
  * Se incluye parámetro de configuración para habilitar/deshabilitar la validación del formato de año natural sobre el campo anualidad del presupuesto de proyecto.
  * Se añade comportamiento configurable sobre el filtro de anualidades de Ejecución económica.
  * Se incluye parámetro de configuración para habilitar/deshabilitar la vista de detalle para Ejecución presupuestaria - Gastos.
  * Se incluye parámetro de configuración para habilitar/deshabilitar la vista de detalle para Detalle operaciones - Gastos.
  * Se incluye parámetro de configuración para habilitar/deshabilitar las opciones de menú de Ejecución Económica.
  * Se incluye parámetro de configuración para habilitar/deshabilitar los buscadores de las pantallas de Ejecución Económica dependientes del SGE.
  * Se amplía parámetro de configuración relativo a la integración del calendario de facturación. Se incluye posibilidad de anular integración habilitando la introducción manual del número de factura.
  * Se añade la acción eliminar relación proyecto SGI-proyectoSGE y su correspondiente parámetro de configuración.
* #### Defectos
  * Corregido defecto que impide guardar un solicitud ética cuando se crea desde CSP.

### sgi-eer-service (Versión 0.3.0)
* #### Nueva funcionalidad
  * Añadido soporte multi-idioma.
* #### Mejoras
  * Actualizado a Java 21.

### sgi-esb-sge (Versión 0.7.0-um)
* #### Mejoras
  * Adaptados los formly a la versión del SGI con soporte multi-idioma.
  * Se añade la acción para notificar la eliminación de relaciones entre proyectos del SGI y el SGE (no está implementada).

### sgi-eti-service (Versión 0.7.0)
* ####  Nueva funcionalidad
  * Añadido soporte multi-idioma.
* ####  Mejoras
  * Actualizado a Java 21.
  * Se aplica mejora en pantallas de ETI para permitir que se cargue todo el listado a pesar que alguna referencia de persona no exista en el sistema externo SGP. Se muestra mensaje de error en los correspondientes campos de visualización de la persona.
  * Añadido soporte para el versionado de los formularios de memoria.
* ####  Defectos
  * Corregido defecto que impide guardar un solicitud ética cuando se crea desde CSP.

### sgi-pii-service (Versión 0.6.0)
* #### Nueva funcionalidad
  * Añadido soporte multi-idioma.
* #### Mejoras
  * Actualizado a Java 21.
  * Se elimina la validación de que una invención solo tenga una solicitud de protección por vía.
  * Se incrementa el tamaño del campo comentarios de solicitudes de protección.

### sgi-prc-service (Versión 0.4.0)
* #### Nueva funcionalidad
  * Añadido soporte multi-idioma.
* #### Mejoras
  * Actualizado a Java 21.
  * Añadida la funcionalidad para que se pueda relacionar un proyecto con un grupo de investigación.

### sgi-rel-service (Versión 0.3.0)
* ####  Nueva funcionalidad
  * Añadido soporte multi-idioma.
* ####  Mejoras
  * Actualizado a Java 21.
  * Añadida la funcionalidad para que se pueda relacionar un proyecto con un grupo de investigación.

### sgi-rep-service (Versión 0.6.0)
* #### Nueva funcionalidad
  * Añadido soporte multi-idioma.
* #### Mejoras
  * Actualizado a Java 21.

### sgi-tp-service (Versión 0.4.0)
* #### Nueva funcionalidad
  * Añadido soporte multi-idioma.
* #### Mejoras
  * Actualizado a Java 21.
* #### Defectos
  * Se corrige defecto en la creación de tareas programadas que provocaba la deshabilitación de tareas futuras.

### sgi-usr-service (Versión 0.4.0)
* #### Nueva funcionalidad
  * Añadido soporte multi-idioma.
* #### Mejoras
  * Actualizado a Java 21.

### sgi-webapp (Versión 0.11.0)
* #### Nueva funcionalidad
  * Añadido soporte multi-idioma.
* #### Mejoras
  * [CSP] Añadido campo "Resumen" en la pantalla de Datos generales de un Grupo de investigación tanto en la creación como en la modificación.
  * [CSP] Añadida la funcionalidad para que se pueda relacionar un proyecto con un grupo de investigación.
  * [CSP] Inclusión de nuevo campo a modo de referencia o código interno de convocatoria. Inclusión de campo año en convocatoria y proyecto.
  * [CSP] Añadido validador para permitir un solo email principal en formly.
  * [CSP] Añadido soporte al componente buscador empresas para buscar solo las empresas principales.
  * [CSP] Se permite la creación de solicitudes sin estar vinculadas a una convocatoria, tanto para el perfil de investigación como para el perfil de gestión.
  * [CSP] Adaptado filtro de solicitudes por finalidad para usar el campo tipoFinalidad de la tabla solicitud.
  * [CSP] Se incluye parámetro de configuración  para habilitar/deshabilitar la validación del formato de año natural sobre el campo anualidad del presupuesto de proyecto.
  * [CSP] Se incluye parámetro de configuración para habilitar/deshabilitar las notificaciones de presupuesto al SGE.
  * [CSP] Se añade comportamiento configurable sobre el filtro de anualidades de Ejecución económica. 
  * [CSP] Se aplica mejora en pantalla de Grupos - Líneas de investigación y en Participación de proyectos externos para permitir que se cargue todo el listado a pesar que alguna referencia de persona no exista en el sistema externo SGP. Se muestra mensaje de error en los correspondientes campos de visualización de la persona.
  * [CSP] Se incluye parámetro de configuración para habilitar/deshabilitar la vista de detalle para Ejecución presupuestaria - Gastos.
  * [CSP] Se incluye parámetro de configuración para habilitar/deshabilitar la vista de detalle para Detalle operaciones - Gastos.
  * [CSP] Se incluye parámetro de configuración para habilitar/deshabilitar las opciones de menú de Ejecución Económica.
  * [CSP] Se incluye parámetro de configuración para habilitar/deshabilitar los buscadores de las pantallas de Ejecución Económica dependientes del SGE.
  * [CSP] Se añade acción de ver detalle de persona en el listado de miembros del equipo de un socio de proyecto.
  * [CSP] Se baja la fuente de las etiquetas de los filtros en las pantallas de Facturas y justificantes y Facturas emitidas de Ejecución Económica.
  * [CSP] Se añade acción de ver detalle de persona en el listado de miembros del equipo de un socio de proyecto de una solicitud.
  * [CSP] Se aplica mejora en pantallas de CSP para permitir que se cargue todo el listado a pesar de que la referencia de alguna entidad no exista en el sistema externo SGEMP. Se muestra mensaje de error en los correspondientes campos de visualización de la entidad
  * [CSP] Se incluye parámetro de configuración para habilitar/deshabilitar las opciones de menú de Ejecución Económica.
  * [CSP] Se incluye parámetro de configuración para habilitar/deshabilitar los buscadores de las pantallas de Ejecución Económica dependientes del SGE.
  * [CSP] Se amplía parámetro de configuración relativo a la integración del calendario de facturación. Se incluye posibilidad de anular integración habilitando la introducción manual del número de factura.
  * [CSP] Se amplía parámetro de configuración relativo a la integración del calendario de facturación. Se incluye posibilidad de anular integración habilitando la introducción manual del número de factura.
  * [CSP] Se muestra mensaje cuando el proyectoSGERef no existe en el SGE al acceder al detalle de un proyecto económico desde el listado de Ejecución Económica.
  * [CSP] Se añade la acción eliminar relación proyecto SGI-proyectoSGE y su correspondiente parámetro de configuración.
  * [ETI] Añadidos parametros de configuración para las plantillas de informe de memoria.
  * [ETI] Se aplica mejora en pantallas de ETI para permitir que se cargue todo el listado a pesar que alguna referencia de persona no exista en el sistema externo SGP. Se muestra mensaje de error en los correspondientes campos de visualización de la persona.
  * [PII] Se aplica mejora en pantallas de PII para permitir que se cargue todo el listado a pesar de que la referencia de alguna entidad no exista en el sistema externo SGEMP. Se muestra mensaje de error en los correspondientes campos de visualización de la entidad
  * [PII] Se aplica mejora en pantallas de PII para permitir que se cargue todo el listado a pesar que alguna referencia de persona no exista en el sistema externo SGP. Se muestra mensaje de error en los correspondientes campos de visualización de la persona
  * [PII] Se incrementa el tamaño del campo comentarios de solicitudes de protección.
  * Mejora en el proceso de exportación de listados limitando la concurrencia para evitar que caduque el token JWT cuando se encolan demasiadas peticiones. 
* #### Defectos
  * [CSP] Se aplica corrección sobre la vista del perfil de investigación. Se estaban listando todos los grupos sin aplicar filtro previo de pertenencia al grupo de la persona logueada.
