<div class="modal-desglose-presupuesto-global">
  <header class="modal-header-material">
    <h3 mat-dialog-title>{{'csp.modal.partida-gasto.titulo' | translate}}</h3>
  </header>
  <main>

    <form [formGroup]="formGroup">

      <!-- Concepto gasto -->
      <div [fxLayout]="fxLayoutProperties.layout" [fxLayoutAlign]="fxLayoutProperties.layoutAlign">
        <div [fxFlex.sm]="fxFlexProperties.sm" [fxFlex.md]="fxFlexProperties.md" [fxFlex.gt-md]="fxFlexProperties.gtMd"
          [fxFlexOrder]="fxFlexProperties.order">
          <mat-form-field fxFill>
            <mat-label>{{'csp.modal.partida-gasto.concepto-gasto' | translate}}</mat-label>
            <input matInput formControlName="conceptoGasto" type="text" id="conceptoGasto"
              placeholder="{{'csp.modal.partida-gasto.concepto-gasto' | translate}}"
              [matAutocomplete]="autoConceptoGasto" required>
            <mat-autocomplete #autoConceptoGasto="matAutocomplete" [displayWith]="getNombreConceptoGasto">
              <mat-option *ngFor="let conceptoGasto of conceptosGasto$ | async" [value]="conceptoGasto">
                {{conceptoGasto.nombre}}
              </mat-option>
            </mat-autocomplete>
            <mat-error *ngIf="formGroup.controls.conceptoGasto.errors?.required">
              {{'csp.modal.partida-gasto.concepto-gasto.error.required' | translate}}
            </mat-error>
          </mat-form-field>
        </div>
      </div>

      <div *ngIf="showCodigosEconomicosInfo">
        <div [fxFlex.sm]="fxFlexPropertiesCodigosEconomicos.sm" [fxFlex.md]="fxFlexPropertiesCodigosEconomicos.md"
          [fxFlex.gt-md]="fxFlexPropertiesCodigosEconomicos.gtMd"
          [fxFlexOrder]="fxFlexPropertiesCodigosEconomicos.order">
          <mat-label>{{'csp.modal.partida-gasto.codigos-economicos-permitidos' | translate}}
          </mat-label>
          <ul *ngFor="let conceptoGasto of conceptosGastosPermitidos">
            <li>
              {{'csp.modal.partida-gasto.concepto-gasto-info' | translate:conceptoGasto}}
              <ul *ngFor="let codigoEconomico of conceptoGasto.codigosEconomicos">
                <li>
                  {{'csp.modal.partida-gasto.codigo-economico-info' |
                  translate:codigoEconomico}}
                </li>
              </ul>
            </li>
          </ul>
        </div>
        <div [fxFlex.sm]="fxFlexPropertiesCodigosEconomicos.sm" [fxFlex.md]="fxFlexPropertiesCodigosEconomicos.md"
          [fxFlex.gt-md]="fxFlexPropertiesCodigosEconomicos.gtMd"
          [fxFlexOrder]="fxFlexPropertiesCodigosEconomicos.order">
          <mat-label>{{'csp.modal.partida-gasto.codigos-economicos-no-permitidos' | translate}}
          </mat-label>
          <ul *ngFor="let conceptoGasto of conceptosGastosNoPermitidos">
            <li>
              {{'csp.modal.partida-gasto.concepto-gasto-info-sin-importe' |
              translate:conceptoGasto}}
              <ul *ngFor="let codigoEconomico of conceptoGasto.codigosEconomicos">
                <li>
                  {{'csp.modal.partida-gasto.codigo-economico-info' |
                  translate:codigoEconomico}}
                </li>
              </ul>
            </li>
          </ul>
        </div>
      </div>

      <!-- Anualidad -->
      <div [fxLayout]="fxLayoutProperties.layout" [fxLayoutAlign]="fxLayoutProperties.layoutAlign">
        <div [fxFlex.sm]="fxFlexProperties.sm" [fxFlex.md]="fxFlexProperties.md" [fxFlex.gt-md]="fxFlexProperties.gtMd"
          [fxFlexOrder]="fxFlexProperties.order">
          <mat-form-field fxFill>
            <mat-label>{{'csp.modal.partida-gasto.anualidad' | translate}}
            </mat-label>
            <input matInput formControlName="anualidad" type="number" id="anualidad" min="0" step="1"
              placeholder="{{'csp.modal.partida-gasto.anualidad' | translate}}">
            <mat-error *ngIf="formGroup.controls.anualidad.errors?.min">
              {{'csp.modal.partida-gasto.anualidad.error.min' | translate}}
            </mat-error>
            <mat-error *ngIf="formGroup.controls.anualidad.errors?.max">
              {{'csp.modal.partida-gasto.anualidad.error.max' | translate}}
            </mat-error>
          </mat-form-field>
        </div>
      </div>

      <!-- Importe solicitado -->
      <div [fxLayout]="fxLayoutProperties.layout" [fxLayoutAlign]="fxLayoutProperties.layoutAlign">
        <div [fxFlex.sm]="fxFlexProperties.sm" [fxFlex.md]="fxFlexProperties.md" [fxFlex.gt-md]="fxFlexProperties.gtMd"
          [fxFlexOrder]="fxFlexProperties.order">
          <mat-form-field fxFill>
            <mat-label>{{'csp.modal.partida-gasto.importe-solicitado' | translate}}
            </mat-label>
            <input matInput formControlName="importeSolicitado" type="number" id="importeSolicitado" min="0" step="1"
              placeholder="{{'csp.modal.partida-gasto.importe-solicitado' | translate}}" required>
            <mat-error *ngIf="formGroup.controls.importeSolicitado.errors?.required">
              {{'csp.modal.partida-gasto.importe-solicitado.error.required' | translate}}
            </mat-error>
            <mat-error *ngIf="formGroup.controls.importeSolicitado.errors?.min">
              {{'csp.modal.partida-gasto.importe-solicitado.error.min' | translate}}
            </mat-error>
            <mat-error *ngIf="formGroup.controls.importeSolicitado.errors?.max">
              {{'csp.modal.partida-gasto.importe-solicitado.error.max' | translate}}
            </mat-error>
          </mat-form-field>
        </div>
      </div>

      <!-- Observaciones -->
      <div>
        <mat-form-field fxFill>
          <mat-label>{{'csp.modal.partida-gasto.observaciones' | translate}}</mat-label>
          <textarea matInput formControlName="observaciones" type="text" id="observaciones"
            placeholder="{{'csp.modal.partida-gasto.observaciones' | translate}}">
              </textarea>
          <mat-error *ngIf="formGroup.controls.observaciones.errors?.maxlength">
            {{'csp.modal.partida-gasto.observaciones.error.maxlength' | translate}}
          </mat-error>
        </mat-form-field>
      </div>

    </form>
  </main>

  <div id="modals-buttons" class="float-right" mat-dialog-actions>
    <button color="accent" (click)="saveOrUpdate()" md-button mat-raised-button type="submit"
      *ngIf="!this.data.readonly">{{textSaveOrUpdate |
      translate}}</button>
    <button class="link-cancelar" mat-button (click)="closeModal()" type="button">{{'botones.cancelar' |
      translate}}</button>
  </div>
</div>