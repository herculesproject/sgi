<section class="plan-investigacion-datos-generales">
  <h2>{{'label.datos-generales' | translate}}</h2>
  <form [formGroup]="formGroup">

    <!-- Número de invención -->
    <div *ngIf="isEdit" [fxLayout]="fxLayoutProperties.layout" [fxLayoutAlign]="fxLayoutProperties.layoutAlign">
      <div [fxFlex.sm]="fxFlexProperties.sm" [fxFlex.md]="fxFlexProperties33.md"
        [fxFlex.gt-md]="fxFlexProperties33.gtMd" [fxFlexOrder]="fxFlexProperties33.order">
        <mat-form-field fxFill>
          <mat-label>{{'pii.invencion.numero-invencion' | translate}}</mat-label>
          <input matInput formControlName="id" type="text" id="id"
            placeholder="{{'pii.invencion.numero-invencion'  | translate}}">
        </mat-form-field>
      </div>
    </div>
    <div [fxLayout]="fxLayoutProperties.layout" [fxLayoutAlign]="fxLayoutProperties.layoutAlign"
      [fxLayoutGap]="fxLayoutProperties.gap">
      <!-- Título -->
      <div [fxFlex.sm]="fxFlexProperties.sm" [fxFlex.md]="fxFlexProperties66.md"
        [fxFlex.gt-md]="fxFlexProperties66.gtMd" [fxFlexOrder]="fxFlexProperties66.order">
        <mat-form-field fxFill>
          <mat-label>{{'pii.invencion.titulo' | translate}}</mat-label>
          <input matInput formControlName="titulo" type="text" id="titulo"
            placeholder="{{'pii.invencion.titulo' | translate}}" required>
          <mat-error *ngIf="formGroup.controls.titulo.errors?.required">
            {{'error.required.entity' | translate:msgParamTituloEntity}}
          </mat-error>
          <mat-error *ngIf="formGroup.controls.titulo.errors?.maxlength">
            {{'error.maxlength.entity' | translate:msgParamTituloEntity}}
          </mat-error>
        </mat-form-field>
      </div>

      <!-- Fecha Comunicación -->
      <div [fxFlex.sm]="fxFlexProperties.sm" [fxFlex.md]="fxFlexProperties33.md"
        [fxFlex.gt-md]="fxFlexProperties33.gtMd" [fxFlexOrder]="fxFlexProperties33.order">
        <mat-form-field fxFill>
          <mat-label>{{'pii.invencion.fecha-comunicacion' | translate}}</mat-label>
          <input matInput formControlName="fechaComunicacion" [matDatepicker]="fechaComunicacion" required>
          <mat-datepicker-toggle matSuffix [for]="fechaComunicacion"></mat-datepicker-toggle>
          <mat-datepicker #fechaComunicacion></mat-datepicker>
          <mat-error *ngIf="formGroup.controls.fechaComunicacion.errors?.required">
            {{'error.required.entity' | translate:msgParamFechaComunicacionEntity}}
          </mat-error>
        </mat-form-field>
      </div>
    </div>

    <!-- Descripción -->
    <div [fxLayout]="fxLayoutProperties.layout" [fxLayoutAlign]="fxLayoutProperties.layoutAlign">
      <div [fxFlex.sm]="fxFlexProperties.sm" [fxFlex.md]="fxFlexProperties.md" [fxFlex.gt-md]="fxFlexProperties.gtMd"
        [fxFlexOrder]="fxFlexProperties.order">
        <mat-form-field fxFill>
          <mat-label>{{'pii.invencion.descripcion' | translate}}</mat-label>
          <textarea matInput formControlName="descripcion" id="descripcion"
            placeholder="{{'pii.invencion.descripcion' | translate}}" required></textarea>
          <mat-error *ngIf="formGroup.controls.descripcion.errors?.required">
            {{'error.required.entity' | translate:msgParamDescripcionEntity}}
          </mat-error>
          <mat-error *ngIf="formGroup.controls.descripcion.errors?.maxlength">
            {{'error.maxlength.entity' | translate:msgParamDescripcionEntity}}
          </mat-error>
        </mat-form-field>
      </div>
    </div>

    <!-- Tipor de Protección -->
    <div [fxLayout]="fxLayoutProperties.layout" [fxLayoutAlign]="fxLayoutProperties.layoutAlign">
      <div [fxFlex.sm]="fxFlexProperties.sm" [fxFlex.md]="fxFlexProperties.md" [fxFlex.gt-md]="fxFlexProperties.gtMd"
        [fxFlexOrder]="fxFlexProperties.order">
        <mat-form-field fxFill>
          <mat-label>{{'pii.invencion.tipo-proteccion' | translate}}</mat-label>
          <sgi-select-entity formControlName="tipoProteccion" [options]=" tiposProteccion$ | async" required>
          </sgi-select-entity>
          <mat-error *ngIf="formGroup.controls.tipoProteccion.errors?.required">
            {{'error.required.entity' | translate:msgParamTipoProteccionEntity}}
          </mat-error>
        </mat-form-field>
      </div>
    </div>

    <!-- Subtipo de Protección -->
    <ng-container *ngIf="subtiposProteccion$ | async as subtiposProteccion">
      <div [fxLayout]="fxLayoutProperties.layout" [fxLayoutAlign]="fxLayoutProperties.layoutAlign"
        *ngIf="subtiposProteccion?.length">
        <div [fxFlex.sm]="fxFlexProperties.sm" [fxFlex.md]="fxFlexProperties.md" [fxFlex.gt-md]="fxFlexProperties.gtMd"
          [fxFlexOrder]="fxFlexProperties.order">
          <mat-form-field fxFill>
            <mat-label>{{'pii.invencion.subtipo-proteccion' | translate}}</mat-label>
            <sgi-select-entity formControlName="subtipoProteccion" [options]=" subtiposProteccion">
            </sgi-select-entity>
          </mat-form-field>
        </div>
      </div>
    </ng-container>

    <!-- Proyecto -->
    <div [fxLayout]="fxLayoutProperties.layout" [fxLayoutAlign]="fxLayoutProperties.layoutAlign">
      <div [fxFlex.sm]="fxFlexProperties.sm" [fxFlex.md]="fxFlexProperties.md" [fxFlex.gt-md]="fxFlexProperties.gtMd"
        [fxFlexOrder]="fxFlexProperties.order">
        <mat-form-field fxFill>
          <mat-label>{{'pii.invencion.proyecto' | translate}}</mat-label>
          <sgi-select-proyecto placeholder="{{'pii.invencion.proyecto' | translate}}" formControlName="proyecto">
          </sgi-select-proyecto>
        </mat-form-field>
      </div>
    </div>

    <!-- Sectores de Aplicación -->
    <div [fxLayout]="fxLayoutProperties.layout" [fxLayoutAlign]="fxLayoutProperties.layoutAlign">
      <div [fxFlex.sm]="fxFlexProperties.sm" [fxFlex.md]="fxFlexProperties.md" [fxFlex.gt-md]="fxFlexProperties.gtMd"
        [fxFlexOrder]="fxFlexProperties.order">
        <h3>{{'pii.sector-aplicacion' | translate:MSG_PARAMS.CARDINALIRY.PLURAL }}</h3>

        <table mat-table [dataSource]="sectorAplicacionDataSource" matSort matSortActive="nombre" matSortDirection="asc"
          matSortDisableClear #sortSectorAplicacion="matSort">

          <!-- Nombre Sector Aplicacion Column -->
          <ng-container matColumnDef="sector">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              {{'pii.invencion.sector' | translate}}
            </th>
            <td mat-cell *matCellDef="let wrapper"> {{wrapper.value.sectorAplicacion.nombre}} </td>
          </ng-container>

          <!-- Acciones Column -->
          <ng-container matColumnDef="acciones">
            <th mat-header-cell *matHeaderCellDef> {{'label.actions' | translate}} </th>
            <td mat-cell *matCellDef="let wrapper; let i = index">
              <ng-container>
                <button *ngIf="formPart.hasEditPerm()" mat-button matTooltip="{{'btn.delete' | translate}}"
                  (click)="deleteSectorAplicacion(wrapper)">
                  <mat-icon color="warn">highlight_off</mat-icon>
                </button>
              </ng-container>
            </td>
          </ng-container>
          <tr mat-header-row *matHeaderRowDef="displayedColumnsSectorAplicacion"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumnsSectorAplicacion;"></tr>
        </table>
        <div class="separation-button" *ngIf="formPart.hasEditPerm">
          <button color="three" mat-button mat-raised-button (click)="openModalSectorAplicacion()">
            <mat-icon color="accent">add_circle</mat-icon>
            {{ 'btn.add.entity' | translate:msgParamSectorAplicacionEntity }}
          </button>
        </div>
      </div>
    </div>
    <mat-error *ngIf="showSectorAplicacionErrorMsg">
      {{'error.required.element' | translate:msgParamSectorAplicacionEntity}}
    </mat-error>

    <!-- Comentarios -->
    <div [fxLayout]="fxLayoutProperties.layout" [fxLayoutAlign]="fxLayoutProperties.layoutAlign">
      <div [fxFlex.sm]="fxFlexProperties.sm" [fxFlex.md]="fxFlexProperties.md" [fxFlex.gt-md]="fxFlexProperties.gtMd"
        [fxFlexOrder]="fxFlexProperties.order">
        <mat-form-field fxFill>
          <mat-label>{{'pii.invencion.comentarios' | translate}}</mat-label>
          <textarea matInput formControlName="comentarios" id="comentarios"
            placeholder="{{'pii.invencion.comentarios' | translate}}"></textarea>
          <mat-error *ngIf="formGroup.controls.comentarios.errors?.maxlength">
            {{'error.maxlength.entity' | translate:msgParamComentariosEntity}}
          </mat-error>
        </mat-form-field>
      </div>
    </div>

  </form>
</section>